<html xmlns:th="http://www.thymeleaf.org" lang="ko">

<head>
	<title>Home</title>
	<meta charset="UTF-8" />
	
	<style>
      table {
        width: 100%;
        border-collapse : collapse
      }
      th, td {
      	border : 1px solid black
      }
      h4 {
      	float : right
      }
    </style>
    
    <script src="js/jQuery-2.1.4.min.js"></script>
    <script src="js/Chart.js"></script>
    
    <script type="text/javascript">
    $(document).ready(function() {
    	
    	var title = $("input")[0].value;
		
		<!-- X축 : 날짜 데이터 취득 -->
		var xField = $("tr td:nth-child(2)");
		var xLength = xField.length;
		var xArray = null;

		if(xLength > 0) {
			xArray = new Array(xLength);
			for(var i = 0; i < xLength; i++) {
				xArray[i] = xField[i].textContent;
			}
		}
		
		<!-- Y축 : 확진환자 수 데이터 취득 -->
		var cField = $("tr td:nth-child(3)");
		var cLength = cField.length;
		var cArray = null;

		if(cLength > 0) {
			cArray = new Array(cLength);
			for(var i = 0; i < cLength; i++) {
				cArray[i] = cField[i].textContent;
			}
		}
		
		<!-- Y축 : 사망자 수 데이터 취득 -->
		var dField = $("tr td:nth-child(4)");
		var dLength = dField.length;
		var dArray = null;

		if(dLength > 0) {
			dArray = new Array(dLength);
			for(var i = 0; i < dLength; i++) {
				dArray[i] = dField[i].textContent;
			}
		}
		
		<!-- Y축 : 격리해제 수 데이터 취득 -->
		var rField = $("tr td:nth-child(5)");
		var rLength = rField.length;
		var rArray = null;

		if(rLength > 0) {
			rArray = new Array(rLength);
			for(var i = 0; i < rLength; i++) {
				rArray[i] = rField[i].textContent;
			}
		}
    
		var ctx = document.getElementById('chartjs').getContext('2d');
		var lineChart = new Chart(ctx, {
    	type: 'line',
	    data: {
	        labels: xArray.reverse(),
	        datasets: [{
	            label: '확진환자',
	            data: cArray.reverse(),
	            borderColor: 'rgba(0,140,232,0.4)',
	            backgroundColor: 'rgba(0,140,232,0.1)',
	            borderWidth: 1.5
	        },
	        {
	            label: '사망자',
	            data: dArray.reverse(),
	            borderColor: 'rgba(224,59,0,4)',
	            backgroundColor: 'rgba(224,59,0,0.1)',
	            borderWidth: 1.5
	        },
	        {
	            label: '격리해제',
	            data: rArray.reverse(),
	            borderColor: 'rgba(252,222,57,0.4)',
	            backgroundColor: 'rgba(252,222,57,0.1)',
	            borderWidth: 1.5
	        }]
	    },
	    options: {
	        title: {
	            display: true,
	            fontColor: '#454b52',
	            fontSize: '20',
	            text: title,
	        	}
	   	}
		});
	});
    </script>
</head>

<body>
	<h1 th:inline="text">국가별 발생 현황</h1>
	<h4 th:inline="text">[[${updatedDate}]]</h4>
	<input type="hidden" th:value="${countryName}"/>
	<canvas id="chartjs" width="400" height="120"></canvas>
	<br>
	<table>
		<tr>
			<th>No.</th>
			<th>날짜</th>
			<th>확진환자</th>
			<th>사망자</th>
			<th>격리해제</th>
		</tr>
		<tr th:each="row : ${worldList}">
			<td th:text="${row.num}"></td>
			<td th:text="${row.updatedDate}"></td>
			<td th:text="${row.confirmed}"></td>
			<td th:text="${row.deaths}"></td>
			<td th:text="${row.recovered}"></td>
		</tr>
	</table>
</body>
